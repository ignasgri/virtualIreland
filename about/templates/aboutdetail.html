{% extends "base.html" %}
{% load static from staticfiles %}
 
{% block content %}

<head>
    <script src="{% static 'js/weather' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/0.6.1/aframe-master.js"></script>
        <style>
       #map {
        height: 400px;
        width: 100%;
       }
    </style>
</head>
<p>weather</p>


<div class="weather-app">
    <div class="left">
<div class="temperature"><span id="temperature">0</span>&deg;</div>
<div class="location"><span id="location">Unknown</span></div>
    </div>
    <div class="right">
<div class="top">
    <img id="icon" width="75px" src="{% static "images/sunny.png" %}"/>
</div>

<div class="bottom">

<div class="humidity">
    <i class="fal fa-tint" aria-hidden="true"></i>
    <span id="humidity">0</span>%
</div>
<div class="wind">
    <span id="wind">0</span>mph <span id="direction">N</span>
</div>

</div>
    </div>
</div>









        <button class="btn btn-success" onclick="location.href='/about'"><span class="glyphicon glyphicon-circle-arrow-left"></span>Back To About</button>
<div class="container-fluid">
        <div class="row">
            <div class="col-sm-12 ">
                <h1 id="locName">{{ abou.title }}</h1>
                
                    
                {% comment %}<a-scene>
      <a-sky src="{{MEDIA_URL}}{{ abou.vr_image}}" rotation="0 275 0"></a-sky>{% endcomment %}

      {% comment %}<a-text font="kelsonsans" value="Guinness Lake" width="6" position="0 0.3 -2"
              rotation="-3 -50 0"></a-text>
    </a-scene>{% endcomment %}
                <div class="t">
                <p>{{ abou.content|linebreaks }}</p>
                <p>{{ abou.published_date }} | <strong>Views</strong> {{ abou.views }} | <strong>Tag</strong> {{ abou.tag }}</p>
                </div>
                <button class="btn btn-success" onclick="location.href='/about'"><span class="glyphicon glyphicon-circle-arrow-left"></span>Back To About</button>
                <button class="btn btn-danger" onclick="location.href='edit'">Edit</button>
        
                   
            </div>
        </div>
</div>

    
<script>
    var APPID = "f5069abcfd0981b52d3b633cb1033c5a";
    var temp;
    var loc;
    var icon;
    var humidity;
    var wind;
    var direction;
    var geo;
    var lat;
    var lng;
    
function updateByGeo(geo){
    var url = "http://api.openweathermap.org/data/2.5/weather?" +
        "lat=" + lat + '&lon=' + lng +
        "&APPID=" + APPID + "&units=metric";
    sendRequest(url);
}

function sendRequest(url){
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function(){
        if (xmlhttp.readyState == 4 && xmlhttp.status ==200){
            var data = JSON.parse(xmlhttp.responseText);
            var weather = {};
            weather.icon = data.weather[0].id;
            weather.humidity = data.main.humidity;
            weather.wind = data.wind.speed;
            weather.direction = data.wind.deg;
            weather.loc = data.name;
            weather.temp = roundNumbers(data.main.temp);
            update(weather);
        }
    };
    xmlhttp.open("GET", url, true);
    xmlhttp.send();
}
function roundNumbers (temp){
    return Math.round(temp);
}

function update(weather){
    wind.innerHTML = weather.wind;
    direction.innerHTML = weather.direction;
    humidity.innerHTML = weather.humidity;
    loc.innerHTML = weather.loc;
    temp.innerHTML = weather.temp;
    icon.src = "static/images/" + weather.icon + ".png";

}

window.onload = function(){
    temp = document.getElementById("temperature");
    loc = document.getElementById("location");
    icon = document.getElementById("icon");
    humidity = document.getElementById("humidity");
    wind = document.getElementById("wind");
    direction = document.getElementById("direction");
    lat = ("{{ abou.latitude}}");
    lng = ("{{ abou.longitude }}");
    

    updateByGeo(geo);
}
</script>


    <h3>My Google Maps Demo</h3>
    <div id="map"></div>

    <script>
        var lat = JSON.parse("{{ abou.latitude|escapejs }}");
        var lng = JSON.parse("{{ abou.longitude|escapejs }}");
      function initMap() {
        var uluru = {lat: lat, lng: lng };
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 15,
          center: uluru
        });
        var marker = new google.maps.Marker({
          position: uluru,
          map: map
        });
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key={GOOGLE_GEOLOCATION_API}&callback=initMap">
    </script>
{% comment %}{% load disqus_tags %}
{% set_disqus_title post.title %}
{% disqus_show_comments %}{% endcomment %}




{% endblock %}